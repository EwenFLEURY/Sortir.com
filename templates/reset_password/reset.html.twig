{% extends 'base.html.twig' %}

{% block title %}Nouveau mot de passe{% endblock %}

{% block body %}
    <section class="container d-flex justify-content-center align-items-center" style="min-height: 70vh;">
        <div class="card shadow-lg border-0 rounded-4" style="max-width: 500px; width: 100%;">
            <div class="card-body p-4">

                <div class="text-center mb-3">
                    <i class="bi bi-key-fill text-primary" style="font-size: 2.5rem;"></i>
                </div>

                <h1 class="h3 text-center fw-bold mb-2">Définir un nouveau mot de passe</h1>
                <p class="text-muted text-center mb-4">
                    Choisissez un mot de passe fort et unique pour sécuriser votre compte.
                </p>

                {{ form_start(resetForm, { attr: { novalidate: 'novalidate', class: 'needs-validation' } }) }}
                {{ form_row(resetForm.plainPassword, {
                    label: 'Nouveau mot de passe',
                    attr: {
                        placeholder: '••••••••',
                        class: 'form-control form-control-lg',
                        autofocus: true
                    }
                }) }}

                <div class="form-text mb-3 text-start">
                    Utilisez au moins 8 caractères avec des majuscules, minuscules, chiffres et symboles.
                </div>

                <button class="btn btn-primary w-100 py-2 rounded-pill" type="submit" data-submit-label="Réinitialisation...">
                    <i class="bi bi-unlock-fill me-1"></i> Réinitialiser le mot de passe
                </button>
                {{ form_end(resetForm) }}

                <hr class="my-4">

                <div class="text-center">
                    <a href="{{ path('app_login') }}" class="link-secondary text-decoration-none">
                        <i class="bi bi-arrow-left-circle me-1"></i> Retour à la connexion
                    </a>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('form.needs-validation');
            if (!form) return;
            form.addEventListener('submit', function () {
                const btn = form.querySelector('button[type="submit"]');
                if (btn) {
                    btn.disabled = true;
                    const original = btn.innerHTML;
                    btn.dataset.original = original;
                    btn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>' +
                        (btn.getAttribute('data-submit-label') || 'Réinitialisation...');
                }
            });
        });
    </script>
{% endblock %}
